{"version":3,"sources":["webpack:///index.min.js","webpack:///webpack/bootstrap d6b5a41178bad65f2985?2b2b","webpack:///./src/index.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","0","$","init_editable","projects_app","editable","name","pk","e","this","parents","data","emptytext","placement","url","success","response","value","project_name","projects","group","attr","type","source","text","status","removeClass","addClass","validate","s","split","length","isNumeric","highlight","rate","parseFloat","burst","init_sortable","Sortable","getColumnType","table","i","find","get","types","numeric","date","alpha","init","update_counters","project","info","undefined","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","d","pending","retry","failed","sum","task","title","toFixed","err","return","paused","time","progress","update_queues","each","on","ev","$this","val","search","show","projects_map","forEach","Vue","el","ready","window","setInterval","methods","project_run","event","hide","_this","target","ajax","result","error","13"],"mappings":"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","file":"index.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 0:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t__webpack_require__(13);\n\t\n\t$(function () {\n\t  //$(\"input[name=start-urls]\").on('keydown', function(ev) {\n\t  //if (ev.keyCode == 13) {\n\t  //var value = $(this).val();\n\t  //var textarea = $('<textarea class=\"form-control\" rows=3 name=\"start-urls\"></textarea>').replaceAll(this);\n\t  //textarea.val(value).focus();\n\t  //}\n\t  //});\n\t\n\t  function init_editable(projects_app) {\n\t    $(\".project-group>span\").editable({\n\t      name: 'group',\n\t      pk: function pk(e) {\n\t        return $(this).parents('tr').data(\"name\");\n\t      },\n\t      emptytext: '[group]',\n\t      placement: 'right',\n\t      url: \"/update\",\n\t      success: function success(response, value) {\n\t        var project_name = $(this).parents('tr').data(\"name\");\n\t        projects_app.projects[project_name].group = value;\n\t        $(this).attr('style', '');\n\t      }\n\t    });\n\t\n\t    $(\".project-status>span\").editable({\n\t      type: 'select',\n\t      name: 'status',\n\t      source: [{ value: 'TODO', text: 'TODO' }, { value: 'STOP', text: 'STOP' }, { value: 'CHECKING', text: 'CHECKING' }, { value: 'DEBUG', text: 'DEBUG' }, { value: 'RUNNING', text: 'RUNNING' }],\n\t      pk: function pk(e) {\n\t        return $(this).parents('tr').data(\"name\");\n\t      },\n\t      emptytext: '[status]',\n\t      placement: 'right',\n\t      url: \"/update\",\n\t      success: function success(response, value) {\n\t        var project_name = $(this).parents('tr').data(\"name\");\n\t        projects_app.projects[project_name].status = value;\n\t        $(this).removeClass('status-' + $(this).attr('data-value')).addClass('status-' + value).attr('data-value', value).attr('style', '');\n\t      }\n\t    });\n\t\n\t    $(\".project-rate>span\").editable({\n\t      name: 'rate',\n\t      pk: function pk(e) {\n\t        return $(this).parents('tr').data(\"name\");\n\t      },\n\t      validate: function validate(value) {\n\t        var s = value.split('/');\n\t        if (s.length != 2) return \"format error: rate/burst\";\n\t        if (!$.isNumeric(s[0]) || !$.isNumeric(s[1])) return \"format error: rate/burst\";\n\t      },\n\t      highlight: false,\n\t      emptytext: '0/0',\n\t      placement: 'right',\n\t      url: \"/update\",\n\t      success: function success(response, value) {\n\t        var project_name = $(this).parents('tr').data(\"name\");\n\t        var s = value.split('/');\n\t        projects_app.projects[project_name].rate = parseFloat(s[0]);\n\t        projects_app.projects[project_name].burst = parseFloat(s[1]);\n\t        $(this).attr('style', '');\n\t      }\n\t    });\n\t  }\n\t\n\t  function init_sortable() {\n\t    // table sortable\n\t    Sortable.getColumnType = function (table, i) {\n\t      var type = $($(table).find('th').get(i)).data('type');\n\t      if (type == \"num\") {\n\t        return Sortable.types.numeric;\n\t      } else if (type == \"date\") {\n\t        return Sortable.types.date;\n\t      }\n\t      return Sortable.types.alpha;\n\t    };\n\t    $('table.projects').attr('data-sortable', true);\n\t    Sortable.init();\n\t  }\n\t\n\t  $(\"#create-project-modal form\").on('submit', function (ev) {\n\t    var $this = $(this);\n\t    var project_name = $this.find('[name=project-name]').val();\n\t    if (project_name.length == 0 || project_name.search(/[^\\w]/) != -1) {\n\t      $this.find('[name=project-name]').parents('.form-group').addClass('has-error');\n\t      $this.find('[name=project-name] ~ .help-block').show();\n\t      return false;\n\t    }\n\t    var mode = $this.find('[name=script-mode]:checked').val();\n\t    $this.attr('action', '/debug/' + project_name);\n\t    return true;\n\t  });\n\t\n\t  function update_counters() {\n\t    $.get('/counter', function (data) {\n\t      for (var project in data) {\n\t        var info = data[project];\n\t        if (projects_app.projects[project] === undefined) continue;\n\t\n\t        // data inject\n\t        var types = \"5m,1h,1d,all\".split(',');\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t          for (var _iterator = types[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t            var type = _step.value;\n\t\n\t            var d = info[type];\n\t            if (d === undefined) continue;\n\t            var pending = d.pending || 0,\n\t                success = d.success || 0,\n\t                retry = d.retry || 0,\n\t                failed = d.failed || 0,\n\t                sum = d.task || pending + success + retry + failed;\n\t            d.task = sum;\n\t            d.title = \"\" + type + \" of \" + sum + \" tasks:\\n\" + (type == \"all\" ? \"pending(\" + (pending / sum * 100).toFixed(1) + \"%): \\t\" + pending + \"\\n\" : \"new(\" + (pending / sum * 100).toFixed(1) + \"%): \\t\\t\" + pending + \"\\n\") + \"success(\" + (success / sum * 100).toFixed(1) + \"%): \\t\" + success + \"\\n\" + \"retry(\" + (retry / sum * 100).toFixed(1) + \"%): \\t\" + retry + \"\\n\" + \"failed(\" + (failed / sum * 100).toFixed(1) + \"%): \\t\" + failed;\n\t          }\n\t        } catch (err) {\n\t          _didIteratorError = true;\n\t          _iteratorError = err;\n\t        } finally {\n\t          try {\n\t            if (!_iteratorNormalCompletion && _iterator.return) {\n\t              _iterator.return();\n\t            }\n\t          } finally {\n\t            if (_didIteratorError) {\n\t              throw _iteratorError;\n\t            }\n\t          }\n\t        }\n\t\n\t        projects_app.projects[project].paused = info['paused'];\n\t        projects_app.projects[project].time = info['5m_time'];\n\t        projects_app.projects[project].progress = info;\n\t      }\n\t    });\n\t  }\n\t\n\t  function update_queues() {\n\t    $.get('/queues', function (data) {\n\t      //console.log(data);\n\t      $('.queue_value').each(function (i, e) {\n\t        var attr = $(e).attr('title');\n\t        if (data[attr] !== undefined) {\n\t          $(e).text(data[attr]);\n\t        } else {\n\t          $(e).text('???');\n\t        }\n\t      });\n\t    });\n\t  }\n\t\n\t  // projects vue\n\t  var projects_map = {};\n\t  projects.forEach(function (p) {\n\t    p.paused = false;\n\t    p.time = {};\n\t    p.progress = {};\n\t    projects_map[p.name] = p;\n\t  });\n\t  var projects_app = new Vue({\n\t    el: '.projects',\n\t    data: {\n\t      projects: projects_map\n\t    },\n\t    ready: function ready() {\n\t      init_editable(this);\n\t      init_sortable(this);\n\t      update_counters();\n\t      window.setInterval(update_counters, 15 * 1000);\n\t      update_queues();\n\t      window.setInterval(update_queues, 15 * 1000);\n\t    },\n\t    methods: {\n\t      project_run: function project_run(project, event) {\n\t        $(\"#need-set-status-alert\").hide();\n\t        if (project.status != \"RUNNING\" && project.status != \"DEBUG\") {\n\t          $(\"#need-set-status-alert\").show();\n\t        }\n\t\n\t        var _this = event.target;\n\t        $(_this).addClass(\"btn-warning\");\n\t        $.ajax({\n\t          type: \"POST\",\n\t          url: '/run',\n\t          data: {\n\t            project: project.name\n\t          },\n\t          success: function success(data) {\n\t            $(_this).removeClass(\"btn-warning\");\n\t            if (!data.result) {\n\t              $(_this).addClass(\"btn-danger\");\n\t            }\n\t          },\n\t          error: function error() {\n\t            $(_this).removeClass(\"btn-warning\").addClass(\"btn-danger\");\n\t          }\n\t        });\n\t      }\n\t    }\n\t  });\n\t}); // vim: set et sw=2 ts=2 sts=2 ff=unix fenc=utf8:\n\t// Author: Binux<i@binux.me>\n\t//         http://binux.me\n\t// Created on 2014-03-02 17:53:23\n\n/***/ }),\n\n/***/ 13:\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ })\n\n/******/ });\n\n\n// WEBPACK FOOTER //\n// index.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d6b5a41178bad65f2985","// vim: set et sw=2 ts=2 sts=2 ff=unix fenc=utf8:\n// Author: Binux<i@binux.me>\n//         http://binux.me\n// Created on 2014-03-02 17:53:23\n\nimport \"./index.less\";\n\n$(function() {\n  //$(\"input[name=start-urls]\").on('keydown', function(ev) {\n    //if (ev.keyCode == 13) {\n      //var value = $(this).val();\n      //var textarea = $('<textarea class=\"form-control\" rows=3 name=\"start-urls\"></textarea>').replaceAll(this);\n      //textarea.val(value).focus();\n    //}\n  //});\n\n  function init_editable(projects_app) {\n    $(\".project-group>span\").editable({\n      name: 'group',\n      pk: function(e) {\n        return $(this).parents('tr').data(\"name\");\n      },\n      emptytext: '[group]',\n      placement: 'right',\n      url: \"/update\",\n      success: function(response, value) {\n        var project_name = $(this).parents('tr').data(\"name\");\n        projects_app.projects[project_name].group = value;\n        $(this).attr('style', '');\n      }\n    });\n\n    $(\".project-status>span\").editable({\n      type: 'select',\n      name: 'status',\n      source: [\n        {value: 'TODO', text: 'TODO'},\n        {value: 'STOP', text: 'STOP'},\n        {value: 'CHECKING', text: 'CHECKING'},\n        {value: 'DEBUG', text: 'DEBUG'},\n        {value: 'RUNNING', text: 'RUNNING'}\n      ],\n      pk: function(e) {\n        return $(this).parents('tr').data(\"name\");\n      },\n      emptytext: '[status]',\n      placement: 'right',\n      url: \"/update\",\n      success: function(response, value) {\n        var project_name = $(this).parents('tr').data(\"name\");\n        projects_app.projects[project_name].status = value;\n        $(this).removeClass('status-'+$(this).attr('data-value')).addClass('status-'+value).attr('data-value', value).attr('style', '');\n      }\n    });\n\n    $(\".project-rate>span\").editable({\n      name: 'rate',\n      pk: function(e) {\n        return $(this).parents('tr').data(\"name\");\n      },\n      validate: function(value) {\n        var s = value.split('/');\n        if (s.length != 2)\n          return \"format error: rate/burst\";\n        if (!$.isNumeric(s[0]) || !$.isNumeric(s[1]))\n          return \"format error: rate/burst\";\n      },\n      highlight: false,\n      emptytext: '0/0',\n      placement: 'right',\n      url: \"/update\",\n      success: function(response, value) {\n        var project_name = $(this).parents('tr').data(\"name\");\n        var s = value.split('/');\n        projects_app.projects[project_name].rate = parseFloat(s[0]);\n        projects_app.projects[project_name].burst = parseFloat(s[1]);\n        $(this).attr('style', '');\n      }\n    });\n  }\n\n  function init_sortable() {\n    // table sortable\n    Sortable.getColumnType = function(table, i) {\n      var type = $($(table).find('th').get(i)).data('type');\n      if (type == \"num\") {\n        return Sortable.types.numeric;\n      } else if (type == \"date\") {\n        return Sortable.types.date;\n      }\n      return Sortable.types.alpha;\n    };\n    $('table.projects').attr('data-sortable', true);\n    Sortable.init();\n  }\n\n  $(\"#create-project-modal form\").on('submit', function(ev) {\n    var $this = $(this);\n    var project_name = $this.find('[name=project-name]').val()\n    if (project_name.length == 0 || project_name.search(/[^\\w]/) != -1) {\n      $this.find('[name=project-name]').parents('.form-group').addClass('has-error');\n      $this.find('[name=project-name] ~ .help-block').show();\n      return false;\n    }\n    var mode = $this.find('[name=script-mode]:checked').val();\n    $this.attr('action', '/debug/'+project_name);\n    return true;\n  });\n\n  function update_counters() {\n    $.get('/counter', function(data) {\n      for (let project in data) {\n        var info = data[project];\n        if (projects_app.projects[project] === undefined)\n          continue;\n\n        // data inject\n        var types = \"5m,1h,1d,all\".split(',');\n        for (let type of types) {\n          var d = info[type];\n          if (d === undefined)\n            continue;\n          var pending = d.pending || 0,\n            success = d.success || 0,\n            retry = d.retry || 0,\n            failed = d.failed || 0,\n            sum = d.task || pending + success + retry + failed;\n          d.task = sum;\n          d.title = \"\"+type+\" of \"+sum+\" tasks:\\n\"\n            +(type == \"all\"\n              ? \"pending(\"+(pending/sum*100).toFixed(1)+\"%): \\t\"+pending+\"\\n\"\n              : \"new(\"+(pending/sum*100).toFixed(1)+\"%): \\t\\t\"+pending+\"\\n\")\n            +\"success(\"+(success/sum*100).toFixed(1)+\"%): \\t\"+success+\"\\n\"\n            +\"retry(\"+(retry/sum*100).toFixed(1)+\"%): \\t\"+retry+\"\\n\"\n            +\"failed(\"+(failed/sum*100).toFixed(1)+\"%): \\t\"+failed;\n        }\n\n        projects_app.projects[project].paused = info['paused'];\n        projects_app.projects[project].time = info['5m_time'];\n        projects_app.projects[project].progress = info;\n      }\n    });\n  }\n\n  function update_queues() {\n    $.get('/queues', function(data) {\n      //console.log(data);\n      $('.queue_value').each(function(i, e) {\n        var attr = $(e).attr('title');\n        if (data[attr] !== undefined) {\n          $(e).text(data[attr]);\n        } else {\n          $(e).text('???');\n        }\n      });\n    });\n  }\n\n  // projects vue\n  var projects_map = {};\n  projects.forEach(function(p) {\n    p.paused = false;\n    p.time = {};\n    p.progress = {};\n    projects_map[p.name] = p;\n  });\n  var projects_app = new Vue({\n    el: '.projects',\n    data: {\n      projects: projects_map\n    },\n    ready: function() {\n      init_editable(this);\n      init_sortable(this);\n      update_counters();\n      window.setInterval(update_counters, 15*1000);\n      update_queues();\n      window.setInterval(update_queues, 15*1000);\n    },\n    methods: {\n      project_run: function(project, event) {\n        $(\"#need-set-status-alert\").hide();\n        if (project.status != \"RUNNING\" && project.status != \"DEBUG\") {\n          $(\"#need-set-status-alert\").show();\n        }\n        \n        var _this = event.target;\n        $(_this).addClass(\"btn-warning\");\n        $.ajax({\n          type: \"POST\",\n          url: '/run',\n          data: {\n            project: project.name\n          },\n          success: function(data) {\n            $(_this).removeClass(\"btn-warning\");\n            if (!data.result) {\n              $(_this).addClass(\"btn-danger\");\n            }\n          },\n          error: function() {\n            $(_this).removeClass(\"btn-warning\").addClass(\"btn-danger\");\n          }\n        });\n      }\n    }\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}